#pragma once

// Whether to use a memory pool for allocation
// (USE_MEMORY_POOL or NOT_USE_MEMORY_POOL).
#define @MEMORY_POOL_OPTION@ 

#ifdef __CUDACC__
  #define DISPATCH_MACRO __device__
#else
  #define DISPATCH_MACRO
#endif

// cpu static variables
#define MEM_POOL_SIZE @MEM_POOL_SIZE@

// NOTE: MAX_BLOCKS is for printlayout function, as a buffer is created
// statically, could change to dynamic
#define MEM_MAX_BLOCKS @MEM_MAX_BLOCKS@

#define MEM_MAX_THREADS @MEM_MAX_THREADS@

#ifdef USE_MEMORY_POOL
  #ifdef __CUDACC__
    #include <memorypool/gpu/poolalloc.cuh>
  #else
    #include <memorypool/cpu/poolalloc.h>  
  #endif
  // #define malloc(size) poolmalloc(size)
  // #define free(ptr)    poolfree(ptr)
  #define swappablemalloc(size) poolmalloc(size)
  #define swappablefree(ptr)    poolfree(ptr)
#else
  #define swappablemalloc(size) malloc(size)
  #define swappablefree(ptr)    free(ptr)
#endif


